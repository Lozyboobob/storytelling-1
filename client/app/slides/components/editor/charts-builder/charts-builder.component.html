<h1>Graph builder
  <small class="pull-right">
    <button md-raised-button type="button" (click)="clearAll()"  color="primary">Reset</button>
  </small>
</h1>

<md-card class="ng-section">
  <md-card-header class="section-header">
    <md-card-title> Your Data </md-card-title>
  </md-card-header>
  <md-card-content class="section-content">
    <span>
        Copy and paste your tabular (TSV, CSV) data here.
        <button class="btn btn-link" (click)="useExample()">(Use example data)</button>
      </span>
    <app-codemirror [(ngModel)]="dataText" [config]="editorConfig">
    </app-codemirror>

    <p *ngIf="dataText.length > 1">
      <span *ngFor="let error of errors" class="text-red">
          <span *ngIf="error.row">Row {{error.row + 2}}: </span>{{error.message}} <br />
      </span>
      <span *ngIf="!errors.length" class="text-green">
          {{rawData.length}} records have been successfully parsed!
        </span>
    </p>
  </md-card-content>
</md-card>

<md-card class="ng-section">
  <md-card-header class="section-header">
    <md-card-title> Select your Chart </md-card-title>
  </md-card-header>
  <md-card-content class="section-content">
    <div fxLayout="row" fxLayoutAlign="center">
      <md-select fxFlex="95%" placeholder="Chart Type" name="chartType" [(ngModel)]="chartType" (change)="processData()">
        <md-option *ngFor="let chart of chartTypes" [value]="chart">
          {{chart.title}}
        </md-option>
      </md-select>
    </div>
  </md-card-content>
</md-card>

<md-card class="ng-section">
  <md-card-header class="section-header">
    <md-card-title> Map your Dimensions </md-card-title>
  </md-card-header>
  <md-card-content *ngIf="hasChartSelected" class="section-content">
    <div fxLayout="row" fxLayoutWrap="wrap" fxLayoutAlign="space-around">

      <div class="dimension" fxFlex.xs="50" fxFlex.sm="50" fxFlex.md="33" fxFlex.lg="20" fxFlex.xl="20">
        <div class="title">Dimensions</div>
        <ul>
          <li *ngFor="let dimension of headerValues" dnd-draggable [dragData]="dimension.name">
            {{dimension.name}}
            <span class="type">{{dimension.type}}</span>
            <span class="pull-right"><i class="fa fa-arrow-right"></i></span>
          </li>
        </ul>
      </div>

      <div class="dimension" *ngFor="let dimensionCol of chartType.dimLabels; let dimIndex = index" dnd-droppable [allowDrop]="allowDropFunction(dimensionCol.maxSize, dimIndex)" (onDropSuccess)="addTobox1Items(dimIndex, $event)">
        <div class="title">{{dimensionCol.column}} <i>(Drop on me)</i></div>
        <ul class="list-unstyled dimensions-list" dnd-sortable-container [sortableData]="dataDims[dimIndex]">
          <li *ngFor="let dimension of dataDims[dimIndex]; let i = index" dnd-sortable [sortableIndex]="i">
            {{dimension}}
            <span class="pull-right" (click)="removeItem(dimIndex, dimension)"><i class="fa fa-times"></i></span>
          </li>
        </ul>
      </div>

    </div>
  </md-card-content>
</md-card>


<md-card class="ng-section">
  <md-card-header class="section-header">
    <md-card-title> Your Visualization </md-card-title>
  </md-card-header>
  <md-card-content *ngIf="hasValidDimensions" class="section-content viz-container">
    <div fxFlex="100%">
      <ngx-charts-bar-vertical-2d *ngIf="chartType.name === 'bar-vertical-2d'" class="chart-container" [scheme]="chartOptions.colorScheme" [schemeType]="chartOptions.schemeType" [results]="data" [gradient]="chartOptions.gradient" [xAxis]="chartOptions.showXAxis"
        [yAxis]="chartOptions.showYAxis" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [tooltipDisabled]="chartOptions.tooltipDisabled"
        [xAxisLabel]="chartOptions.xAxisLabel" [yAxisLabel]="chartOptions.yAxisLabel" [showGridLines]="chartOptions.showGridLines" xxxbarPadding="chartOptions.barPadding" xxxgroupPadding="chartOptions.groupPadding" [roundDomains]="chartOptions.roundDomains">
      </ngx-charts-bar-vertical-2d>
      <ngx-charts-bar-horizontal-2d *ngIf="chartType.name === 'bar-horizontal-2d'" class="chart-container" [scheme]="chartOptions.colorScheme" [schemeType]="chartOptions.schemeType" [results]="data" [gradient]="chartOptions.gradient" [tooltipDisabled]="chartOptions.tooltipDisabled"
        [xAxis]="chartOptions.showXAxis" [yAxis]="chartOptions.showYAxis" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel"
        [yAxisLabel]="chartOptions.yAxisLabel" [showGridLines]="chartOptions.showGridLines" [roundDomains]="chartOptions.roundDomains">
      </ngx-charts-bar-horizontal-2d>
      <ngx-charts-bar-vertical-stacked *ngIf="chartType.name === 'bar-vertical-stacked'" class="chart-container" [scheme]="chartOptions.colorScheme" [schemeType]="chartOptions.schemeType" [results]="data" [gradient]="chartOptions.gradient" [tooltipDisabled]="chartOptions.tooltipDisabled"
        [xAxis]="chartOptions.showXAxis" [yAxis]="chartOptions.showYAxis" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel"
        [yAxisLabel]="chartOptions.yAxisLabel" [showGridLines]="chartOptions.showGridLines" [roundDomains]="chartOptions.roundDomains">
      </ngx-charts-bar-vertical-stacked>
      <ngx-charts-bar-horizontal-stacked *ngIf="chartType.name === 'bar-horizontal-stacked'" class="chart-container" [scheme]="chartOptions.colorScheme" [schemeType]="chartOptions.schemeType" [results]="data" [gradient]="chartOptions.gradient" [xAxis]="chartOptions.showXAxis"
        [yAxis]="chartOptions.showYAxis" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel" [yAxisLabel]="chartOptions.yAxisLabel"
        [showGridLines]="chartOptions.showGridLines" [roundDomains]="chartOptions.roundDomains">
      </ngx-charts-bar-horizontal-stacked>
      <ngx-charts-bar-vertical-normalized *ngIf="chartType.name === 'bar-vertical-normalized'" class="chart-container" [scheme]="chartOptions.colorScheme" [schemeType]="chartOptions.schemeType" [results]="data" [gradient]="chartOptions.gradient" [tooltipDisabled]="chartOptions.tooltipDisabled"
        [xAxis]="chartOptions.showXAxis" [yAxis]="chartOptions.showYAxis" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel"
        [yAxisLabel]="chartOptions.yAxisLabel" [showGridLines]="chartOptions.showGridLines" [roundDomains]="chartOptions.roundDomains">
      </ngx-charts-bar-vertical-normalized>
      <ngx-charts-bar-horizontal-normalized *ngIf="chartType.name === 'bar-horizontal-normalized'" class="chart-container" [scheme]="chartOptions.colorScheme" [schemeType]="chartOptions.schemeType" [results]="data" [gradient]="chartOptions.gradient" [tooltipDisabled]="chartOptions.tooltipDisabled"
        [xAxis]="chartOptions.showXAxis" [yAxis]="chartOptions.showYAxis" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel"
        [yAxisLabel]="chartOptions.yAxisLabel" [showGridLines]="chartOptions.showGridLines" [roundDomains]="chartOptions.roundDomains">
      </ngx-charts-bar-horizontal-normalized>
      <ngx-charts-polar-chart *ngIf="chartType.name === 'polar-chart'" class="chart-container" [scheme]="chartOptions.colorScheme" [schemeType]="chartOptions.schemeType" [results]="data" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle"
        [gradient]="chartOptions.gradient" [xAxis]="chartOptions.showXAxis" [yAxis]="chartOptions.showYAxis" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel" [yAxisLabel]="chartOptions.yAxisLabel"
        [autoScale]="chartOptions.autoScale" [showGridLines]="chartOptions.showGridLines" [rangeFillOpacity]="chartOptions.rangeFillOpacity" [roundDomains]="chartOptions.roundDomains" [tooltipDisabled]="chartOptions.tooltipDisabled" [curve]="chartOptions.curveClosed"
        [showSeriesOnHover]="chartOptions.showSeriesOnHover">
      </ngx-charts-polar-chart>
      <ngx-charts-line-chart *ngIf="chartType.name === 'line-chart'" class="chart-container" [scheme]="chartOptions.colorScheme" [schemeType]="chartOptions.schemeType" [results]="data" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle"
        [gradient]="chartOptions.gradient" [xAxis]="chartOptions.showXAxis" [yAxis]="chartOptions.showYAxis" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel" [yAxisLabel]="chartOptions.yAxisLabel"
        [autoScale]="chartOptions.autoScale" [showGridLines]="chartOptions.showGridLines" [curve]="chartOptions.curve" [rangeFillOpacity]="chartOptions.rangeFillOpacity" [roundDomains]="chartOptions.roundDomains" [tooltipDisabled]="chartOptions.tooltipDisabled"
        [showSeriesOnHover]="chartOptions.showSeriesOnHover">
      </ngx-charts-line-chart>
      <ngx-charts-heat-map *ngIf="chartType.name === 'heat-map'" class="chart-container" [scheme]="chartOptions.colorScheme" [results]="data" [legend]="chartOptions.showLegend" [gradient]="chartOptions.gradient" [xAxis]="chartOptions.showXAxis" [yAxis]="chartOptions.showYAxis"
        [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel" [yAxisLabel]="chartOptions.yAxisLabel" xxxinnerPadding="chartOptions.innerPadding" [tooltipDisabled]="chartOptions.tooltipDisabled">
      </ngx-charts-heat-map>
      <ngx-charts-bubble-chart *ngIf="chartType.name === 'bubble-chart'" [view]="null" class="chart-container" [results]="data" [showGridLines]="chartOptions.showGridLines" [legend]="chartOptions.showLegend" [legendTitle]="chartOptions.legendTitle" [xAxis]="chartOptions.showXAxis"
        [yAxis]="chartOptions.showYAxis" [showXAxisLabel]="chartOptions.showXAxisLabel" [showYAxisLabel]="chartOptions.showYAxisLabel" [xAxisLabel]="chartOptions.xAxisLabel" [yAxisLabel]="chartOptions.yAxisLabel" [autoScale]="chartOptions.autoScale" [scheme]="chartOptions.colorScheme"
        [schemeType]="chartOptions.schemeType" [roundDomains]="chartOptions.roundDomains" [tooltipDisabled]="chartOptions.tooltipDisabled" [minRadius]="3" [maxRadius]="20">
      </ngx-charts-bubble-chart>
      <ngx-charts-tree-map *ngIf="chartType.name === 'treemap'" [view]="null" [scheme]="chartOptions.colorScheme" [results]="data">
      </ngx-charts-tree-map>

      <app-bar-chart *ngIf="chartType.name === 'bar-chart'" [dataInput]="data">
      </app-bar-chart>
      <app-pie-chart *ngIf="chartType.name === 'pie-chart'" [dataInput]="data">
      </app-pie-chart>
      <ngx-charts-pie-grid *ngIf="chartType.name === 'pie-grid-chart'" class="pie-grid-container" [view]="null" [scheme]="chartOptions.colorScheme" [results]="data">
      </ngx-charts-pie-grid>
      <app-dendogram *ngIf="chartType.name === 'dendogram'" [dataInput]="data">
      </app-dendogram>
      <app-force-directed-graph *ngIf="chartType.name === 'force-directed-graph'" [dataInput]="data">
      </app-force-directed-graph>
      <app-zoomable-treemap-chart *ngIf="chartType.name === 'zoomable-treemap'" [dataInput]="data">
      </app-zoomable-treemap-chart>
    </div>
  </md-card-content>
</md-card>
